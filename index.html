<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>pentf</title>
	<meta name="description" content="Documentation for pentf">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">pentf</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1>pentf</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#pentf---parallel-end-to-end-test-framework" id="pentf---parallel-end-to-end-test-framework" style="color: inherit; text-decoration: none;">
					<h1>pentf - Parallel End-To-End Test Framework</h1>
				</a>
				<p>pentf runs end-to-end tests (with or without web browsers, emails, and/or direct HTTP requests) in a highly parallel manner, so that tests bound by client CPU can run while other tests are waiting for an email to arrive or slow external servers to answer.</p>
				<p>Tests are written in plain JavaScript, typically using node&#39;s built-in <a href="https://nodejs.org/api/assert.html">assert</a>. You can use any other assertion framework too; a test is simply an <code>async</code> function which throws an exception to indicate test failure.</p>
				<p>Browser tests using <a href="https://pptr.dev/">puppeteer</a> benefit from special support such as isolation of parallel tests and screenshots of test failures as well as a number of <a href="https://boxine.github.io/pentf/modules/_browser_utils_.html">helper functions</a>, for example to wait for text to become visible.</p>
				<p>Depending on the environment (you can set up configurations to run the same tests against dev, stage, prod etc.), tests can be skipped, or marked as <em>expected to fail</em> for test driven development where you write tests first before fixing a bug or implementing a feature.
					A locking system prevents two tests or the same tests on two different machines from accessing a shared resource, e.g. a test account.
				You can review test results in a PDF report.</p>
				<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
					<h2>Installation</h2>
				</a>
				<pre><code class="language-shell">npm i --save-dev pentf puppeteer</code></pre>
				<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
					<h2>Usage</h2>
				</a>
				<p>pentf can be used as a library (A standalone binary is also planned). Create a script named <code>run</code> in the directory of your tests, and fill it like this:</p>
				<pre><code class="language-javascript"><span class="hljs-meta">#!/usr/bin/env node</span>
<span class="hljs-built_in">require</span>(<span class="hljs-string">'pentf'</span>).main({
    <span class="hljs-attr">rootDir</span>: __dirname,
    <span class="hljs-attr">description</span>: <span class="hljs-string">'Test my cool application'</span>,
});</code></pre>
				<p>Make the file executable with <code>chmod a+x run</code>, and from then on type</p>
				<pre><code class="language-shell">./run</code></pre>
				<p>to execute all tests. You may also want to have a look at the <a href="#options">options</a>.</p>
				<a href="#writing-tests" id="writing-tests" style="color: inherit; text-decoration: none;">
					<h2>Writing tests</h2>
				</a>
				<p>Plop a new <code>.js</code> file into <code>tests/</code>. Its name will be the test&#39;&#39;s name, and it should have an async <code>run</code> function, like this:</p>
				<pre><code class="language-javascript"><span class="hljs-keyword">const</span> assert = <span class="hljs-built_in">require</span>(<span class="hljs-string">'assert'</span>).strict;
<span class="hljs-keyword">const</span> {getMail} = <span class="hljs-built_in">require</span>(<span class="hljs-string">'pentf/email'</span>);
<span class="hljs-keyword">const</span> {newPage, closePage} = <span class="hljs-built_in">require</span>(<span class="hljs-string">'pentf/browser_utils'</span>);
<span class="hljs-keyword">const</span> {fetch} = <span class="hljs-built_in">require</span>(<span class="hljs-string">'pentf/net_utils'</span>);
<span class="hljs-keyword">const</span> {makeRandomEmail} = <span class="hljs-built_in">require</span>(<span class="hljs-string">'pentf/utils'</span>);

<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">run</span>(<span class="hljs-params">config</span>) </span>{
    <span class="hljs-keyword">const</span> email = makeRandomEmail(config, <span class="hljs-string">'pentf_example'</span>);
    <span class="hljs-keyword">const</span> start = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(config, <span class="hljs-string">'https://api.tonie.cloud/v2/users'</span>, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
        <span class="hljs-attr">headers</span>: {
            <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
        },
        <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify({
            <span class="hljs-attr">locale</span>: <span class="hljs-string">'en'</span>,
            <span class="hljs-attr">email</span>: email,
            <span class="hljs-attr">password</span>: <span class="hljs-string">'Secret123'</span>,
            <span class="hljs-attr">acceptedGeneralTerms</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">acceptedPrivacyTerms</span>: <span class="hljs-literal">true</span>,
        }),
    });
    assert.equal(response.status, <span class="hljs-number">201</span>);
    assert((<span class="hljs-keyword">await</span> response.json()).jwt);

    <span class="hljs-keyword">const</span> mail = <span class="hljs-keyword">await</span> getMail(config, start, email, <span class="hljs-string">'Your Toniecloud confirmation link'</span>);
    assert(mail);

    <span class="hljs-comment">// Test with a browser</span>
    <span class="hljs-keyword">const</span> page = <span class="hljs-keyword">await</span> newPage(config);
    <span class="hljs-keyword">await</span> page.goto(<span class="hljs-string">'https://meine.tonies.de/'</span>);

    <span class="hljs-comment">// During development, you can make the test fail.</span>
    <span class="hljs-comment">// Run with -k to see the browser's state at this time!</span>
    <span class="hljs-comment">// Any test failure is fine, but in a pinch, try uncommenting:</span>

    <span class="hljs-comment">// assert(false);</span>

    <span class="hljs-keyword">await</span> closePage(page);
}

<span class="hljs-built_in">module</span>.exports = {
    run,
    <span class="hljs-attr">description</span>: <span class="hljs-string">'pentf test example'</span>, <span class="hljs-comment">// optional description for test reports, can be left out</span>

    <span class="hljs-comment">// You can skip the test in some conditions by defining an optional skip method:</span>
    <span class="hljs-attr">skip</span>: <span class="hljs-function"><span class="hljs-params">config</span> =&gt;</span> config.env === <span class="hljs-string">'prod'</span>,

    <span class="hljs-comment">// Optional: a true-ish value to indicate that to suppress output about this test if it fails.</span>
    <span class="hljs-comment">// Used to indicate tests for bugs/features that are not yet implemented (e.g. with TDD).</span>
    <span class="hljs-comment">// Strings will be reported; the URL to an issue is a good and typical value.</span>
    <span class="hljs-comment">// Alternatively, a function that is called with the config and returns a value as described above.</span>
    <span class="hljs-attr">expectedToFail</span>: <span class="hljs-function"><span class="hljs-params">config</span> =&gt;</span> (config.env === <span class="hljs-string">'alwaysbroken'</span>) ? <span class="hljs-string">'Known to be broken here'</span> : <span class="hljs-literal">false</span>,

    <span class="hljs-comment">// Resources is a list of strings. Tests accessing the same resources are run sequentially.</span>
    <span class="hljs-attr">resources</span>: [<span class="hljs-string">'toniebox_1234'</span>, <span class="hljs-string">'another_resource'</span>],
    <span class="hljs-comment">// Default is one resource with the name `test_${test.name}`, i.e. tests are not run concurrently by default</span>
    <span class="hljs-comment">// Using no shared resources? Set resources: []</span>
};</code></pre>
				<p>Note that while the above example tests a webpage with <a href="https://github.com/GoogleChrome/puppeteer">puppeteer</a> and uses pentf&#39;s has native support for HTTP requests (in <code>net_utils</code>) and email sending (in <code>email</code>), tests can be anything – they just have to fail the promise if the test fails.</p>
				<p>Have a look in the <a href="https://boxine.github.io/pentf/">API documentation</a> for various helper functions.</p>
				<a href="#tips-for-writing-good-tests" id="tips-for-writing-good-tests" style="color: inherit; text-decoration: none;">
					<h2>Tips for writing good tests</h2>
				</a>
				<p>By their very nature, end-to-end tests can be flaky, i.e. sometimes succeed and sometimes fail when run multiple times. We want the tests to only relay the flakiness of the systems we test, and not introduce any additional flakiness ourselves. Here are a few tips for that:</p>
				<a href="#use-data-testid-attributes-in-browser-tests" id="use-data-testid-attributes-in-browser-tests" style="color: inherit; text-decoration: none;">
					<h3>Use <code>data-testid</code> attributes in browser tests</h3>
				</a>
				<p>Unless otherwise documented, class names and document structures are subject to change. By setting an explicit attribute like <code>data-testid=&quot;comment-button&quot;</code> in the code, the developer and tester set up a stable contract.</p>
				<p><strong>Avoid</strong>: <code>await page.waitForSelector(&#39;h1 &gt; div.main-container form p button.large-button&#39;);</code></p>
				<p><strong>Use</strong>: <code>await waitForTestId(page, &#39;comment-button&#39;);</code></p>
				<a href="#always-wait-a-bit" id="always-wait-a-bit" style="color: inherit; text-decoration: none;">
					<h3>Always wait a bit</h3>
				</a>
				<p>If the tests run quick and a remote system is slow, the browser UI may not update immediately. If there is high local system load (which is necessary for the tests to run quickly), then even local updates may not be immediate:</p>
				<p><strong>Avoid</strong>: <code>page.$(&#39;foo&#39;)</code>, <code>page.evaluate(() =&gt; document.querySelector(&#39;foo&#39;))</code></p>
				<p><strong>Use</strong>: <code>page.waitForSelector(&#39;foo&#39;)</code></p>
				<p><strong>Avoid</strong>: <code>page.type(&#39;#foo&#39;, &#39;bar&#39;)</code></p>
				<p><strong>Use</strong>: <code>browser_utils.typeSelector(page, &#39;#foo&#39;, &#39;bar&#39;)</code></p>
				<a href="#make-sure-you-start-waiting-early" id="make-sure-you-start-waiting-early" style="color: inherit; text-decoration: none;">
					<h3>Make sure you start waiting <em>early</em></h3>
				</a>
				<p>Make sure that an action you are waiting on has not already happend. In particular, <code>await page.waitForNavigation()</code> calls should probably be replaced by checks for the new page.</p>
				<p><strong>Avoid</strong>:</p>
				<pre><code class="language-javascript"><span class="hljs-keyword">await</span> page.press(<span class="hljs-string">'Enter'</span>);
<span class="hljs-comment">// If the page is quick, navigation may have already occured here!</span>
<span class="hljs-keyword">await</span> page.waitForNavigation();
<span class="hljs-keyword">await</span> waitForText(page, <span class="hljs-string">'email sent'</span>);

<span class="hljs-keyword">const</span> since = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(); <span class="hljs-comment">// Too late, email may already have been sent!</span>
<span class="hljs-keyword">await</span> getMail(config, since, email, <span class="hljs-string">'Enter was pressed'</span>);</code></pre>
				<p><strong>Use</strong>:</p>
				<pre><code class="language-javascript"><span class="hljs-keyword">const</span> since = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
<span class="hljs-keyword">await</span> page.press(<span class="hljs-string">'Enter'</span>);
<span class="hljs-keyword">await</span> waitForText(page, <span class="hljs-string">'email sent'</span>);

<span class="hljs-keyword">await</span> getMail(config, since, email, <span class="hljs-string">'Enter was pressed'</span>);</code></pre>
				<a href="#click-atomically-if-the-application-updates-its-dom-a-lot" id="click-atomically-if-the-application-updates-its-dom-a-lot" style="color: inherit; text-decoration: none;">
					<h3>Click atomically if the application updates its DOM a lot</h3>
				</a>
				<p>If the application rerenders its DOM with JavaScript, you must take special care not to hold onto handles, because they might be invalid (the DOM nodes replaced by other ones) by the time you interact with them again.</p>
				<p><strong>Avoid</strong>:</p>
				<pre><code class="language-javascript"><span class="hljs-keyword">const</span> buttonHandle = <span class="hljs-keyword">await</span> page.waitForSelector(<span class="hljs-string">'button[data-testid="send-email"]'</span>);
buttonHandle.click();</code></pre>
				<p><strong>Use</strong> atomic clicking functions, e.g. from <a href="https://boxine.github.io/pentf/modules/_browser_utils_.html"><code>browser_utils</code></a>:</p>
				<pre><code class="language-javascript"><span class="hljs-keyword">await</span> clickTestId(page, <span class="hljs-string">'send-email'</span>);</code></pre>
				<a href="#segregate-tests-by-service" id="segregate-tests-by-service" style="color: inherit; text-decoration: none;">
					<h3>Segregate tests by service</h3>
				</a>
				<p>While the ultimate end-to-end test tests all services, it can be very helpful to add a test naming schema so that it&#39;s immediately clear which service or application errored. Even at the cost of some redundancy, backend tests e.g. using <a href="https://boxine.github.io/pentf/modules/_net_utils_.html#fetch"><code>fetch</code></a> (tip: check out the <code>--print-curl</code> option) instead of a full browser allow anyone to quickly see whether the problem occurs in the backend .</p>
				<p>Note that this does <strong>not</strong> mean that test failures in other projects can be ignored: If a browser-based test often fails because of a certain API endpoint, that API endpoint should get its own test and further investigation.</p>
				<p><strong>Use</strong>: If suitable, get a test naming scheme, e.g. <code>email_deleted</code>, <code>email_notification</code>, <code>sms_notification</code>. That way, with <code>-f email_</code> you can run all email tests, and with <code>_notification</code> you can run all notification tests. Use a negative lookahead like <code>^(?!email_|carrier-pidgeon_)</code> to exclude some tests.</p>
				<a href="#assert-early-and-often" id="assert-early-and-often" style="color: inherit; text-decoration: none;">
					<h3>assert early and often</h3>
				</a>
				<p>When an error occurs, the test should abort immediately and not keep going on. This makes it clear where the error is and avoids confusion. A helpful error message is quick to write and saves a lot of debugging time later.</p>
				<p><strong>Avoid</strong>:</p>
				<pre><code class="language-javascript"><span class="hljs-keyword">const</span> id = data.foo.bar.id;
<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`https://example.org/widget/<span class="hljs-subst">${id}</span>`</span>);
<span class="hljs-keyword">const</span> text = <span class="hljs-keyword">await</span> response.text();</code></pre>
				<p>What happens if the ID is not found? Then we will request <code>https://example.org/widget/undefined</code>!
				If the server is down, the text we get back may be an error page.</p>
				<p><strong>Use</strong>:</p>
				<pre><code class="language-javascript"><span class="hljs-keyword">const</span> id = data.foo.bar.id;
assert(id, <span class="hljs-string">'ID is not set – unrecognized error in the backend?'</span>);
<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`https://example.org/widget/<span class="hljs-subst">${id}</span>`</span>);
assert.equal(response.status, <span class="hljs-number">200</span>);
<span class="hljs-keyword">const</span> text = <span class="hljs-keyword">await</span> response.text();</code></pre>
				<a href="#use-assert-in-strict-mode" id="use-assert-in-strict-mode" style="color: inherit; text-decoration: none;">
					<h3>Use <code>assert</code> in strict mode</h3>
				</a>
				<p>In <a href="https://nodejs.org/api/assert.html#assert_strict_assertion_mode">strict assertion mode</a>, <code>assert</code> generates better errors and is generally easier to deal with.</p>
				<p><strong>Avoid</strong>: <code>const assert = require(&#39;assert&#39;);</code></p>
				<p><strong>Use</strong>: <code>const assert = require(&#39;assert&#39;).strict;</code></p>
				<a href="#skipping-tests" id="skipping-tests" style="color: inherit; text-decoration: none;">
					<h2>Skipping tests</h2>
				</a>
				<p>If a test should not run within an environment – maybe the tested service is not available in that environment, or you don&#39;t want to run a DoS test against prod – you can skip it. Simply export a function <code>skip</code> that gets called with the pentf configuration object. It returns true or a non-empty string to indicate that the test should be skipped, like this:</p>
				<pre><code class="language-javascript"><span class="hljs-built_in">module</span>.exports = {
    run,
    <span class="hljs-attr">skip</span>: <span class="hljs-function"><span class="hljs-params">config</span> =&gt;</span> (config.env === <span class="hljs-string">'prod'</span>) &amp;&amp; <span class="hljs-string">'This test could impact customers and is therefore not run against prod'</span>,
};</code></pre>
				<a href="#test-driven-development-with-expectedtofail" id="test-driven-development-with-expectedtofail" style="color: inherit; text-decoration: none;">
					<h2>Test-driven development with <code>expectedToFail</code></h2>
				</a>
				<p>If you write the test before a bug is fixed or a new feature is deployed, you can mark the test as <code>expectedToFail</code>. An <code>expectedToFail</code> test is still run, but if it fails the pipeline will still be green. If an <code>expectedToFail</code> test succeeds, a warning is printed, but the test is still seen as successful. It is a good idea to include a ticket number in the output so that everybody can look up the status, like this:</p>
				<pre><code class="language-javascript"><span class="hljs-built_in">module</span>.exports = {
    run,
    <span class="hljs-attr">expectedToFail</span>: <span class="hljs-function"><span class="hljs-params">config</span> =&gt;</span> [<span class="hljs-string">'stage'</span>, <span class="hljs-string">'prod'</span>].includes(config.env) &amp;&amp; <span class="hljs-string">'Not yet rolled out (BUG-1234)'</span>,
};</code></pre>
				<p>You can also mark a code section instead of a full test with the <a href="https://boxine.github.io/pentf/modules/_promise_utils_.html#expectedtofail">function <code>expectedToFail</code></a>.</p>
				<p>Use <code>-E</code>/<code>--expect-nothing</code> to disable the expectedToFail special treatment.</p>
				<a href="#configuration" id="configuration" style="color: inherit; text-decoration: none;">
					<h2>Configuration</h2>
				</a>
				<p>pentf is designed to be run against different configurations, e.g. local/dev/stage/prod. Create files in the <code>config</code> subdirectory for each environment, in one of the following formats:</p>
				<ul>
					<li>JSON: A <code>.json</code> file with the keys and associated values. (<a href="tests/config_examples/json.json">example</a>)</li>
					<li>Simple JavaScript: A <code>.js</code> file which exports the configuration. (<a href="tests/config_examples/simple_javascript.js">example</a>)</li>
					<li>Async JavaScript: A <code>.js</code> file which exports an async function being called with the environment name and returning the configuration. (<a href="tests/config_examples/async_javascript.js">example</a>)</li>
				</ul>
				<p>You can also add a programatic configuration for multiple environments by passing a function <code>defaultConfig</code> to <code>pentf.main</code>; see <a href="run">pentf&#39;s own run</a> for an example.</p>
				<p>The keys are up to you; for example you probably want to have a main entry point. pentf claims the following keys:</p>
				<ul>
					<li><strong><code>extends</code></strong> Inherit from the specified environment. It is common to have a <code>_common</code> environment (i.e. a file <code>_common.json</code> or <code>common.</code>) which all environments inherit from. You can also construct combined environments, e.g. prod backend with a development frontend.</li>
					<li><strong><code>external_locking_url</code></strong> Base URL of the external lockserver to use to avoid test runs on different machines using shared resources (such as test accounts, limited widgets etc.) at the same time (see <em>locking</em> below).</li>
					<li><strong><code>email</code></strong> The base email address used in <a href="https://boxine.github.io/pentf/modules/_utils_.html#makerandomemail"><code>makeRandomEmail</code></a>.</li>
					<li><strong><code>imap</code></strong> If you are using the <code>pentf/email</code> module to fetch and test emails, configure your imap connection here, like<pre><code><span class="hljs-string">"imap"</span>: {
  <span class="hljs-string">"user"</span>: <span class="hljs-string">"user@example.com"</span>,
  <span class="hljs-string">"password"</span>: <span class="hljs-string">"secret"</span>,
  <span class="hljs-string">"host"</span>: <span class="hljs-string">"mail.example.com"</span>,
  <span class="hljs-string">"port"</span>: <span class="hljs-number">993</span>,
  <span class="hljs-string">"tls"</span>: <span class="hljs-literal">true</span>
}</code></pre></li>
					<li><strong><code>rejectUnauthorized</code></strong> Set to <code>false</code> to not check the certificate in TLS connections.</li>
				</ul>
				<a href="#options" id="options" style="color: inherit; text-decoration: none;">
					<h2>Options</h2>
				</a>
				<pre><code>-h, --help            Show this help message and <span class="hljs-keyword">exit</span>.
-e YOUR_ENVIRONMENTS, --env YOUR_ENVIRONMENTS
                      The environment to test against. Default is local.
--version             Print version of tests and test framework and <span class="hljs-keyword">exit</span>.</code></pre>
				<a href="#output" id="output" style="color: inherit; text-decoration: none;">
					<h6>Output</h6>
				</a>
				<pre><code>-v, --verbose         Let tests output diagnostic details
-q, --quiet           <span class="hljs-keyword">Do</span> not output <span class="hljs-keyword">test</span> status
--<span class="hljs-keyword">no</span>-<span class="hljs-keyword">clear</span>-<span class="hljs-keyword">line</span>, --<span class="hljs-keyword">ci</span>
                      Never <span class="hljs-keyword">clear</span> the current output <span class="hljs-keyword">line</span> (<span class="hljs-keyword">as</span> <span class="hljs-keyword">if</span> output is not a tty)
--<span class="hljs-keyword">print</span>-config        Output the effective configuration and <span class="hljs-keyword">exit</span>.
-c, --<span class="hljs-keyword">print</span>-curl      <span class="hljs-keyword">Print</span> curl commands <span class="hljs-keyword">for</span> each HTTP request
-I REGEXP, --ignore-errors REGEXP
                      <span class="hljs-keyword">Do</span> not output <span class="hljs-keyword">error</span> messages matching the regular expression. Example: -I 
                      <span class="hljs-string">"\(TOC-[0-9]+\)"</span>
-<span class="hljs-keyword">E</span>, --expect-nothing  Ignore expectedToFail attributes <span class="hljs-keyword">on</span> tests
--<span class="hljs-keyword">no</span>-colors           Disable colors <span class="hljs-keyword">in</span> stdout</code></pre>
				<a href="#writing-results-to-disk" id="writing-results-to-disk" style="color: inherit; text-decoration: none;">
					<h6>Writing results to disk</h6>
				</a>
				<pre><code>-J, --json            <span class="hljs-keyword">Write</span> tests results <span class="hljs-keyword">as</span> a JSON <span class="hljs-keyword">file</span>.
--json-<span class="hljs-keyword">file</span> <span class="hljs-keyword">FILE</span>.json
                      JSON <span class="hljs-keyword">file</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">write</span> <span class="hljs-keyword">to</span>. Defaults <span class="hljs-keyword">to</span> results.json .
-H, --html            <span class="hljs-keyword">Write</span> test results <span class="hljs-keyword">as</span> an HTML <span class="hljs-keyword">file</span>.
--html-<span class="hljs-keyword">file</span> <span class="hljs-keyword">FILE</span>.html
                      HTML <span class="hljs-keyword">file</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">write</span> a report <span class="hljs-keyword">to</span>. Defaults <span class="hljs-keyword">to</span> results.html .
--pdf                 <span class="hljs-keyword">Write</span> test results <span class="hljs-keyword">as</span> a PDF <span class="hljs-keyword">file</span>. (Now enabled by <span class="hljs-keyword">default</span>)
--no-pdf              <span class="hljs-keyword">Do</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">write</span> a PDF report <span class="hljs-keyword">with</span> test results.
--pdf-<span class="hljs-keyword">file</span> <span class="hljs-keyword">FILE</span>.pdf   PDF <span class="hljs-keyword">file</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">write</span> a report <span class="hljs-keyword">to</span>. Defaults <span class="hljs-keyword">to</span> results.pdf .
-M, --markdown        <span class="hljs-keyword">Write</span> tests results <span class="hljs-keyword">as</span> a Markdown <span class="hljs-keyword">file</span>.
--markdown-<span class="hljs-keyword">file</span> <span class="hljs-keyword">FILE</span>.md
                      Markdown <span class="hljs-keyword">file</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">write</span> a report <span class="hljs-keyword">to</span>. Defaults <span class="hljs-keyword">to</span> results.md .
--load-json INPUT.json
                      Load test results from JSON (instead <span class="hljs-keyword">of</span> executing tests)
--sentry              Enable error reporting via Sentry. By <span class="hljs-keyword">default</span>, this will be activated <span class="hljs-keyword">if</span> the CI 
                      environment variable <span class="hljs-keyword">is</span> <span class="hljs-keyword">set</span> <span class="hljs-keyword">and</span> a SENTRY_DSN <span class="hljs-keyword">is</span> configured.
--no-sentry           Disable error reporting via Sentry even <span class="hljs-keyword">if</span> it <span class="hljs-keyword">is</span> configured
--sentry-dsn OVERRIDE_SENTRY_DSN
                      <span class="hljs-keyword">Override</span> Sentry DSN. By <span class="hljs-keyword">default</span>, the SENTRY_DSN environment variable <span class="hljs-keyword">is</span> used.</code></pre>
				<a href="#test-selection" id="test-selection" style="color: inherit; text-decoration: none;">
					<h6>Test selection</h6>
				</a>
				<pre><code>-f REGEXP, <span class="hljs-comment">--filter REGEXP</span>
                      Regular expression <span class="hljs-keyword">to</span> match names <span class="hljs-keyword">of</span> tests <span class="hljs-keyword">to</span> <span class="hljs-built_in">run</span>
-b REGEXP, <span class="hljs-comment">--filter-body REGEXP</span>
                      Run only tests <span class="hljs-keyword">whose</span> full code <span class="hljs-keyword">is</span> matched <span class="hljs-keyword">by</span> this regular expression
-l, <span class="hljs-comment">--list            List all tests that would be run and exit</span>
-a, <span class="hljs-comment">--all, --include-slow-tests</span>
                      Run tests <span class="hljs-keyword">that</span> take a very long <span class="hljs-built_in">time</span></code></pre>
				<a href="#email" id="email" style="color: inherit; text-decoration: none;">
					<h6>Email</h6>
				</a>
				<pre><code>--<span class="hljs-meta">keep</span>-emails         <span class="hljs-meta">Keep</span> generated emails instead of deleting them
--email-verbose       Log all IMAP commands <span class="hljs-keyword">and </span>responses</code></pre>
				<a href="#puppeteer-browser-test" id="puppeteer-browser-test" style="color: inherit; text-decoration: none;">
					<h6>puppeteer browser test</h6>
				</a>
				<pre><code>-V, --visible         Make browser tests visible (i.e. <span class="hljs-keyword">not</span> headless)
--no-screenshots      <span class="hljs-keyword">Do</span> <span class="hljs-keyword">not</span> take screenshots of browser failures
--screenshot-directory DIR
                      Directory <span class="hljs-keyword">to</span> write screenshots <span class="hljs-keyword">to</span> (default: ./screenshots)
-s MS, --slow-mo MS   Wait this many milliseconds after every call <span class="hljs-keyword">to</span> the virtual browser
-k, --keep-open       Keep browser sessions open <span class="hljs-keyword">in</span> case of failures. Implies -V.
--devtools            Start browser with devtools open. Implies -V
--devtools-preserve   Configure devtools <span class="hljs-keyword">to</span> preserve logs <span class="hljs-keyword">and</span><span class="hljs-built_in"> network </span>requests upon navigation. Implies 
                      --devtools
--extensions [EXTENSION_DIR [EXTENSION_DIR <span class="hljs-built_in">..</span>.]]
                      Load unpacked browser extensions
--forward-console     Forward browser<span class="hljs-built_in"> console </span>logs</code></pre>
				<a href="#test-runner" id="test-runner" style="color: inherit; text-decoration: none;">
					<h6>Test runner</h6>
				</a>
				<pre><code>-C COUNT, --concurrency COUNT
                      Maximum number of tests to run <span class="hljs-keyword">in</span> parallel. <span class="hljs-number">0</span> to run without a pool, sequentially. 
                      Defaults to <span class="hljs-number">10</span>.
-S, --sequential      Do not run tests <span class="hljs-keyword">in</span> parallel (same as -C <span class="hljs-number">0</span>)
--fail-fast           Abort once a test fails
--print-tasks         Output all tasks that the runner would perform, and <span class="hljs-keyword">exit</span>
--<span class="hljs-keyword">exit</span>-zero           Terminate with <span class="hljs-keyword">exit</span> code <span class="hljs-number">0</span> (success) even <span class="hljs-keyword">if</span> tests fail. (Exit codes != <span class="hljs-number">0</span> are still 
                      emitted <span class="hljs-keyword">in</span> cases of internal crashes)
--repeat COUNT        Run the tests the specified number of times</code></pre>
				<a href="#locking" id="locking" style="color: inherit; text-decoration: none;">
					<h6>Locking</h6>
				</a>
				<pre><code>-L, --no-locking      Completely disable any locking of resources between tests.
--locking-verbose     Output status messages about locking
--list-conflicts      Show which tasks conflict on which resources, and <span class="hljs-keyword">exit</span> immediately
--manually-lock RESOURCES
                      Externally lock the specified comma-separated resources <span class="hljs-keyword">for</span> <span class="hljs-number">60</span>s before the test
--list-locks, --list-external-locks
                      List (external) locks and <span class="hljs-keyword">exit</span>
--clear-locks, --clear-external-locks
                      Clear all external locks and <span class="hljs-keyword">exit</span>
--no-external-locking
                      Disable external locking (via a lockserver)
--external-locking-url URL
                      Override URL of lockserver
--display-locking-client
                      Display the locking client ID we would use <span class="hljs-keyword">if</span> we would lock something now</code></pre>
				<a href="#license" id="license" style="color: inherit; text-decoration: none;">
					<h2>License</h2>
				</a>
				<p><a href="LICENSE">MIT</a>. Patches welcome!</p>
				<a href="#deprecation-policy" id="deprecation-policy" style="color: inherit; text-decoration: none;">
					<h2>Deprecation policy</h2>
				</a>
				<p>Sometimes, we have to deprecate or move a legacy name or feature. The pentf deprecation policy is as following:</p>
				<ol>
					<li>For 6 months, a warning is only output if the <code>PENTF_FUTURE_DEPRECATIONS</code> environment variable is set. </li>
					<li>Deprecation warnings are output all the time, but everything continues to work for 6 more months.</li>
					<li>Afterwards, as long as we can find any usages of the legacy variant, we keep supporting it.</li>
					<li>Finally, once there are no known usages of the legacy variant, we stop support alltogether.</li>
				</ol>
				<p>Note that the times only apply if we cannot prove that all usages have been moved.</p>
				<a href="#currently-deprecated" id="currently-deprecated" style="color: inherit; text-decoration: none;">
					<h3>Currently deprecated</h3>
				</a>
				<table>
					<thead>
						<tr>
							<th>Feature</th>
							<th>Replaced by</th>
							<th>Deprecation start</th>
						</tr>
					</thead>
					<tbody><tr>
							<td><code>utils.assertEventually</code></td>
							<td><code>assert_utils.assertEventually</code></td>
							<td>2020-11-19</td>
						</tr>
						<tr>
							<td><code>utils.assertAsyncEventually</code></td>
							<td><code>assert_utils.assertAsyncEventually</code></td>
							<td>2020-11-19</td>
						</tr>
						<tr>
							<td><code>utils.assertAlways</code></td>
							<td><code>assert_utils.assertAlways</code></td>
							<td>2020-11-19</td>
						</tr>
				</tbody></table>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_assert_utils_.html">&quot;assert_<wbr>utils&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_browser_console_.html">&quot;browser_<wbr>console&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_browser_utils_.html">&quot;browser_<wbr>utils&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_config_.html">&quot;config&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_curl_command_.html">&quot;curl_<wbr>command&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_email_.html">&quot;email&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_external_locking_.html">&quot;external_<wbr>locking&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_index_.html">&quot;index&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_loader_.html">&quot;loader&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_locking_.html">&quot;locking&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_main_.html">&quot;main&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_net_utils_.html">&quot;net_<wbr>utils&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_output_.html">&quot;output&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_pentf_example_.html">&quot;pentf_<wbr>example&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_promise_utils_.html">&quot;promise_<wbr>utils&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_render_.html">&quot;render&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_results_.html">&quot;results&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_runner_.html">&quot;runner&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_update_readme_.html">&quot;update-<wbr>readme&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_utils_.html">&quot;utils&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_version_.html">&quot;version&quot;</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="assets/js/search.js"><' + '/script>');</script>
</body>
</html>